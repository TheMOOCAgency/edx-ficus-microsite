<%page expression_filter="h"/>
<%inherit file="/main.html" />
<%namespace name='static' file='/static_content.html'/>
<%def name="online_help_token()"><% return "courseware" %></%def>
<%!
from django.utils.translation import ugettext as _
from django.conf import settings
from edxnotes.helpers import is_feature_enabled as is_edxnotes_enabled
from openedx.core.djangolib.markup import HTML
from openedx.core.djangolib.js_utils import js_escaped_string, dump_js_escaped_json
from openedx.core.djangoapps.site_configuration import helpers as configuration_helpers
from datetime import datetime, date
import json
from tma_apps.tma_support_functions import tma_verify_access
primary_color = configuration_helpers.get_value('primary_color')
%>



<%block name="pagetitle">${_("Attestation de reussite")}</%block>

<!-- COMMON STYLE-->
<style>
  h1,h2,h3,h4,h5,p{
    color: #222222;
    font-family: inherit;
    text-align: center;
  }

  p{
    padding:10px;
    margin:0 0 0 0 !important;
  }
  h1{
    font-size: 48px;
    font-weight: 500;
    margin-bottom: 0px;
  }
  h2{
    font-size: 28px;
    font-weight: 500;
    margin-bottom: 100px;
  }
  h3{
    font-size: 24px;
    font-weight: 900;
    max-width: 550px;
    margin: 30px 0;
  }

  h4{
    font-size: 16px;
    font-weight: 900;
  }

  #custom-btn{
    background: ${primary_color};
    border: none;
    box-shadow: none;
    text-shadow: none;
  }

  #certificate-wrapper{
    background: white;
    padding-bottom: 40px;
    min-height: calc(100vh - 133px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
  }
  #certificate-container{
    width:794px;
    height:1120px;
    margin: 0 auto;
    position: relative;
  }

  #certificate-content{
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  #certificate-border{
    position:absolute;
    top:0;
    bottom:0;
    left:0;
    height: 100%;
  }

  #certificate-border #triangle3{
    position:absolute;
    bottom:0;
    left:0;
    width: 0;
    height: 0;
    border-style: solid;
    border-width: 600px 0 0 150px;
    border-color: transparent transparent transparent #007bff;
    border-image: linear-gradient(180deg, rgba(1,123,194,1) 35%, rgba(1,178,194,1) 100%);

  }

  
  #certificate-border #triangle2{
    position:absolute;
    bottom:0;
    left:0;
    width: 0;
    height: 0;
    border-style: solid;
    border-width: 1000px 0 0 120px;
    border-color: transparent transparent transparent green;
    border-image: linear-gradient(180deg, rgba(1,123,194,1) 35%, rgba(1,178,194,1) 100%);

  }

  #certificate-border #triangle1{
    position:absolute;
    top:0;
    left:0;
    width: 0;
    height: 0;
    border-style: solid;
    border-width: 1120px 120px 0 0;
    border-color: red transparent transparent transparent;
    border-image: linear-gradient(180deg, rgba(1,123,194,1) 35%, rgba(1,178,194,1) 100%);
  }

  #certificate-planes{
    position:absolute;
    bottom:0;
    right:0;
    height: 50%;
    opacity: 0.2;
   }

   #osac-logo{
     height: 120px;
     margin: 50px 0 60px;
   }

  #pdf-btn-wrapper{
    padding: 15px
  }
  #certificate-title{
    text-transform: uppercase;
  }
  #noCertificateMessage{
    background: white;
    height: calc(100vh - 133px);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
  }

  #certificate-content .legend {
    margin: 70px 0 30px 20px!important;
    text-align: left;
    font-size: 12px;
  }

  #bottom-address {
    display: flex;
    align-items: center;
    flex-direction: column;
    margin-top: 60px;
    font-size: 12px;
  }

  #bottom-address p{
    padding: 0;
  }
</style>

<!-- CUSTOM STYLE -->
<style>

</style>
% if grades.get('passed') or  tma_verify_access(request.user).is_tma_team():
  <div id="certificate-wrapper">
    <div id="pdf-btn-wrapper">
      <button id="custom-btn" onclick="CertificateToPdf()">TELECHARGER PDF</button>
    </div>
    <div id="certificate-container">
      <div id="certificate-border">
        <!-- <div id="triangle1"></div>
        <div id="triangle2"></div>
        <div id="triangle3"></div> -->
        <div class="triangle"></div>
      </div>
      <img src="/media/microsite/osac-mooc/images/certificate-border.png" id="certificate-border" alt="Border"/>
      <img src="/media/microsite/osac-mooc/images/certificate-planes.png" id="certificate-planes" alt="Planes"/>
      <div id="certificate-content">
        <img src="/media/microsite/osac-mooc/auto/images/logo.png" alt="OSAC logo" id="osac-logo"/>
        <div id="certificate-title">
          <h1>Certificate</h1>
          <h2>of achievement</h2>
        </div>
        <div>
          <p>This is to acknowledge that</p>
          <h3>${first_name} ${last_name}</h3>
          <p>has successfully* completed the</p>
          <p>OSAC MOOC module</p>
          <h3>${course_name}</h3>
          <h4>30 march 2020</h4>
          <p class="legend">* with a score of more than 75 %</p>
        </div>
      </div>
      <div id="bottom-address">
        <h4>OSAC</h4>
        <p>14 boulevard des Frères Voisin - Immeuble Zénéo</p>
        <p>92137 Issy-les-Moulineaux Cedex</p>
        <p>Tél. : 33 (0)1 41 46 50 - Fax : 33 (0)1 46 42 65 39</p>
        <p><a href="https://www.osac.aero" >www.osac.aero</a></p>
      </div>
    </div>
  </div>
%else:
  <div id="noCertificateMessage">
      <h3>Certificat Non Disponible</h3>
      <p>Vous n'avez pas atteint le score minimal requis pour obtenir votre certificat.</p>
  </div>
%endif

<!-- PDF CREATOR-->
<script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.debug.js"></script>
<script>
  function CertificateToPdf(){
     html2canvas(document.getElementById("certificate-container"), {
      onrendered : function (canvas){
       var img=canvas.toDataURL("image/png");
       var doc = new jsPDF({orientation: 'portrait'});
       doc.addImage(img, "PNG", 0, 0);
       doc.save("certificat.pdf");
      }
    })
  }
  //AVOID INTERNET EXPLORER NOT WORKING WITH HTML2CANVAS
  $(document).ready(function(){
    if(navigator.userAgent.indexOf("Firefox")<0 && navigator.userAgent.indexOf("Chrome")<0 && navigator.userAgent.indexOf("Safari")<0){
    $('#pdf-btn-wrapper').html("${_('Download PDF : This feature is not available on Internet Explorer. Please use Chrome Mozilla or Safari to get your pdf')}")
    }
  })
</script>

