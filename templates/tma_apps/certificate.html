<%page expression_filter="h"/>
<%inherit file="/main.html" />
<%namespace name='static' file='/static_content.html'/>
<%def name="online_help_token()"><% return "courseware" %></%def>
<%!
from django.utils.translation import ugettext as _
from django.conf import settings
from edxnotes.helpers import is_feature_enabled as is_edxnotes_enabled
from openedx.core.djangolib.markup import HTML
from openedx.core.djangolib.js_utils import js_escaped_string, dump_js_escaped_json
from openedx.core.djangoapps.site_configuration import helpers as configuration_helpers
from datetime import datetime, date
import json

%>

<%block name="pagetitle">${_("Certificat de reussite")}</%block>

<%
if request.user.email.find("themoocagency.com")>-1 and user.is_active and user.is_staff :
  is_tma_team=True
else :
  is_tma_team=False
%>

<link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet">

<style>

  /* General */
  h1,h2,h3,p{
    font-family: 'Open Sans', sans-serif;
  }

  p {
    font-size: 1.2rem;
  }

  #global-navigation,.wrapper-footer,#tma_background_font {
    display: none !important;
  }

  .container{
    margin-top:80px;
    width:854px;
    height:480px;
    margin-left: 70px;
    padding: 0;
    border: 1px solid lightgray;
  }
  #main {
    background-image:url('/media/microsite/mooc-airbus/auto/images/bg_img.jpg');
    background-size:cover;
    background-position:center;
  }
  .main-color{
    background-color:rgba(0,26,92,0.7);
  }
  .second-color{
    background-color: #4d4d4d;
  }
  .texte-gras{
    font-weight: 600;
  }

  /* Premier bandeau */
  .bandeau-top{
    padding: 10px;
    margin-bottom: 25px
  }
  .bandeau-top p{
    font-weight: 600;
    color: white;
    margin-top: 15px;
  }
  .title-attestation{
    width: 80%;
    float: left;
  }
  .title-box {
    width: 400px;
    height: auto;
    color: white;
    margin: auto;
    padding: 20px 10px;
    font-weight: bold;
  }
  .title-box > p {
    font-size: 1.4rem;
  }
  
  .logo-attestation{
    width: 20%;
    float: left;
    text-align: right;
  }
  .logo-attestation img{
    max-height: 45px;
    padding: 5px 5px 5px 5px;
  }

  /* Deuxième bandeau */
  .bandeau-middle{
    color: white;
    margin: 30px 100px 20px 100px;
    padding: 20px 30px;
  }
  #course-title{
    font-size: 1.4rem;
    font-weight: bold;
  }
  #nom-user{
    font-size: 1.4rem;
    font-weight: bold;
  }
  #score {
    font-weight: bold;
  }
  #macaron {
    position: absolute;
    top: 295px;
    left: 745px;
  }
  #macaron img {
    height: 150px;
  }

  /* Footer */
  .footer-right, .footer-left{
    float: left;
  }
  .footer-right img{
    max-height: 80px;
  }
  .footer-right{
    text-align: right;
    width: 20%;
  }
  .footer-left{
    /*width: 80%;*/
  }
  .footer{
    background-color: white;
    padding: 10px;
    margin-top: 46px;
  }
  .footer p{
    margin-top: 10px;
    font-size: 12px;
    text-align: left;
  }

  #bouton-pdf{
    background-color: darkgray;
    color: gray;
    border-color: gray;
    background-image: none;
    box-shadow: none;
    text-shadow: none;
    border-radius: 5px;
    font-weight: 600;
    margin-top: 150px;
    margin-left: 420px;
  }
</style>

% if grades.get('passed') or is_tma_team:
  <div class="container" id="main">
    <div class="bandeau-top" style="background-color:white;">
      <div class="logo-attestation">
        <img id="certificate_logo" src="/media/microsite/mooc-airbus/auto/images/logo.png"/>
      </div>
      <div style="clear:both;"></div>
    </div>

    <div class="title-box main-color">
      <p style="text-align:center">CERTIFICATE OF ACHIEVEMENT</p>
    </div>

    <div class="bandeau-middle main-color" style="text-align: left;">
      <p>This certificate is presented to</p>
      <p id="nom-user">${first_name} ${last_name}</p>
      <p>in recognition of the achievement of</p>
      <p class="texte-gras" id="course-title">${course_name}</p>
      <p>with the grade <span id="score">${grades.get('grade')*100}%</span></p>
      <div id="macaron"><img src="/media/microsite/mooc-airbus/cert/macaron.png" alt="macaron"></div>
    </div>

    <!--<div class="footer">
        <div class="footer-left">
          <p>Code de vérification : <span id="security_hash">${hash}</span> – A vérifier sur <a id="check_link" target="_blank" href="https://services.themoocagency.com/check?MOOC=${course_name}">https://services.themoocagency.com/check</a></p>
        </div>
        <div style="clear:both;"></div>
    </div>-->
  </div>
  <button id="bouton-pdf" onclick="printpage()">VERSION PDF</button>

  <script src="/media/dashboard/bootstrap/bootstrap.min.js" charset="utf-8"></script>
  <script type="text/javascript">
  </script>
  
  <script
    src="https://code.jquery.com/jquery-2.2.4.min.js"
    integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.debug.js"></script>
  <script type="text/javascript">
    //PDF VERSION
    function printpage(){
      html2canvas($('#main'), {
        onrendered : function(canvas){
        var img=canvas.toDataURL("image/png");
        var doc = new jsPDF({orientation: 'landscape'});
        doc.addImage(img, "PNG", 20, 20);
        doc.save("certificat.pdf");
        }
      })
    }
    
    var d = new Date();
    var now = d.getDate()+'/'+(d.getMonth()+1)+'/'+d.getFullYear();
    $("#date_deliver").append(" "+now);
  </script>
% endif
