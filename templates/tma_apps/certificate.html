<%page expression_filter="h"/>
<%inherit file="/main.html" />
<%namespace name='static' file='/static_content.html'/>
<%def name="online_help_token()"><% return "courseware" %></%def>
<%!
from django.utils.translation import ugettext as _
from django.conf import settings
from edxnotes.helpers import is_feature_enabled as is_edxnotes_enabled
from openedx.core.djangolib.markup import HTML
from openedx.core.djangolib.js_utils import js_escaped_string, dump_js_escaped_json
from openedx.core.djangoapps.site_configuration import helpers as configuration_helpers
from datetime import datetime, date
import json
from tma_apps.tma_support_functions import tma_verify_access

primary_color = configuration_helpers.get_value('primary_color')
background_url = configuration_helpers.get_value('bg_img')
%>

<%
org = static.get_value('domain_prefix')
%>

<%block name="pagetitle">${_("Certificat de reussite")}</%block>

<!-- COMMON STYLE-->

<style>

@font-face {
      font-family: inteloFamilyMedium;
      src: url("/media/microsite/${org}/fonts/inteloAltMedium.otf");
    }
    @font-face {
      font-family: inteloFamilyLight;
      src: url("/media/microsite/${org}/fonts/inteloLight.otf");
    }
  h1,h2,h3,h4,h5,p{
    font-family: "inteloFamilyMedium"
  }
  p{
    padding:10px
  }
  h4{
    font-size: 1.5rem;
  }
  h3{
    font-size: 1.7rem
  }
  #certificate-wrapper{
    background: white;
  }


  #custom-btn{
    background: ${primary_color};
    border: none;
    box-shadow: none;
    text-shadow: none;
  }

  #certificate-wrapper{
    min-height: calc(100vh - 133px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: contain;
  }
  #certificate-container {
    width:854px;
    height:462px;
    margin: 0 auto;
    padding: 20px;
    background-size: contain;
  }

  .certificate-container_manager{
    background-image: url('/media/microsite/${org}/images/certificate/manager_fr.png');
  }
  .certificate-container_socialschool{
    background-image: url('/media/microsite/${org}/images/certificate/socialschool_fr.png');
  }

  .certificate-container_data-ia{
    background-image: url('/media/microsite/${org}/images/certificate/data_ia_fr.png');
  }

  .certificate-container_expedition{
    background-image: url('/media/microsite/${org}/images/certificate/expeditions_fr.png');
  }
  .certificate-container_passeport{
    background-image: url('/media/microsite/${org}/images/certificate/passeportnumerique_fr.png');
  }

  .certificate-container_voyages{
    background-image: url('/media/microsite/${org}/images/certificate/voyages_fr.png');
  }

  /* english background */
.certificate-container_manager_en{
    background-image: url('/media/microsite/${org}/images/certificate/manager_en.png');
  }
  .certificate-container_socialschool_en{
    background-image: url('/media/microsite/${org}/images/certificate/socialschool_en.png');
  }

  .certificate-container_data-ia_en{
    background-image: url('/media/microsite/${org}/images/certificate/data_ia_en.png');
  }

  .certificate-container_expedition_en{
    background-image: url('/media/microsite/${org}/images/certificate/expeditions_en.png');
  }
  .certificate-container_passeport_en{
    background-image: url('/media/microsite/${org}/images/certificate/passeportnumerique_en.png');
  }
  .certificate-container_voyages_en{
    background-image: url('/media/microsite/${org}/images/certificate/voyages_en.png');
  }

  /* spanish background */
  .certificate-container_manager_es{
    background-image: url('/media/microsite/${org}/images/certificate/manager_es.png');
  }
  .certificate-container_socialschool_es{
    background-image: url('/media/microsite/${org}/images/certificate/socialschool_es.png');
  }

  .certificate-container_data-ia_es{
    background-image: url('/media/microsite/${org}/images/certificate/data_ia_es.png');
  }

  .certificate-container_expedition_es{
    background-image: url('/media/microsite/${org}/images/certificate/expeditions_es.png');
  }
  .certificate-container_passeport_es{
    background-image: url('/media/microsite/${org}/images/certificate/passeportnumerique_es.png');
  }
  .certificate-container_voyages_es{
    background-image: url('/media/microsite/${org}/images/certificate/voyages_es.png');
  }

    /* german background */
    .certificate-container_manager_de{
    background-image: url('/media/microsite/${org}/images/certificate/manager_de.png');
  }
  .certificate-container_socialschool_de{
    background-image: url('/media/microsite/${org}/images/certificate/socialschool_de.png');
  }

  .certificate-container_data-ia_de{
    background-image: url('/media/microsite/${org}/images/certificate/data_ia_de.png');
  }

  .certificate-container_expedition_de{
    background-image: url('/media/microsite/${org}/images/certificate/expeditions_de.png');
  }
  .certificate-container_passeport_de{
    background-image: url('/media/microsite/${org}/images/certificate/passeportnumerique_de.png');
  }
  .certificate-container_voyages_de{
    background-image: url('/media/microsite/${org}/images/certificate/voyages_de.png');
  }


  #pdf-btn-wrapper{
    padding: 15px
  }

  #noCertificateMessage{
    background: white;
    height: calc(100vh - 133px);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
  }

  .logo_company{
    position: relative;
    top: 48px;
    left: 682px;
    width: 130px;
  }

  .logo_company_manager{
    position: relative;
    top: 69px;
    left: 674px;
    width: 130px;
  }

  .logo_company_socialschool{
    position: relative;
    top: 99px;
    left: 673px;
    width: 130px;
  }

  .logo_company_data-ia{
    position: relative;
    top: 81px;
    left: 679px;
    width: 130px;
  }

  .logo_company_voyages{
    position: relative;
    top: 67px;
    left: 39px;
    width: 130px;
  }

  .logo_company_expedition{
    position: relative;
    top: 90px;
    left: 46px;
    width: 130px;
  }

  .user_name{
    position: relative;
    top: 55px;
    text-align: center;
    /* left: 315px; */
    font-size: 1.5em;
    text-transform: uppercase;
    /* text-decoration: underline; */



  }

  .user_name_voyages{
    position: relative;
    top: 52px;
    text-align: center;
    /* left: 312px; */
    font-size: 1.5em;
    text-transform: uppercase;
    /* text-decoration: underline; */
  }

  .user_name_data-ia{
    position: relative;
    top: 85px;
    text-align: center;
    /* left: 316px; */
    font-size: 1.5em;
    text-transform: uppercase;
    /* text-decoration: underline; */
  }

  .user_name_manager{
    position: relative;
    top: 56px;
    text-align: center;
    /* left: 314px; */
    font-size: 1.5em;
    text-transform: uppercase;
    /* text-decoration: underline; */
  }

  .user_name_expedition{
    position: relative;
    top: 55px;
    text-align: center;
    /* left: 316px; */
    font-size: 1.5em;
    text-transform: uppercase;
    /* text-decoration: underline; */
  }

  .user_name_socialschool{
    position: relative;
    top: 56px;
    text-align: center;
    /* left: 316px; */
    font-size: 1.5em;
    text-transform: uppercase;
    /* text-decoration: underline; */
  }



  
  .date_today{
    position: relative;
    top: 286px;
    left: 194px;
    font-size: 0.9em;
    font-weight: bold;
  }
  .date_today_manager{
    position: relative;
    font-size: 0.9em;
    font-weight: bold;
    top: 274px;
    left: 228px;
  }

  .date_today_socialschool{
    position: relative;
    font-size: 0.9em;
    font-weight: bold;
    top: 286px;
    left: 201px;
  }

  .date_today_data-ia{
    position: relative;
    font-size: 0.9em;
    font-weight: bold;
    top: 283px;
    left: 201px;
  }

  .date_today_voyages{
    position: relative;
    font-size: 0.9em;
    font-weight: bold;
    top: 282px;
    left: 216px;
  }

  .date_today_expedition{
    position: relative;
    font-size: 0.9em;
    font-weight: bold;
    top: 282px;
    left: 216px;
  }
</style>

<!-- CUSTOM STYLE -->
<style>

</style>
% if grades.get('passed') or  tma_verify_access(request.user).is_tma_team():
<div id="certificate-wrapper">
  <div id="pdf-btn-wrapper">
    <button id="custom-btn" onclick="CertificateToPdf()">TELECHARGER PDF</button>
  </div>
  % if request.path == '/tma_apps/course-v1:edf-netexploacademy+Netexplo_passeport+2018_T2_passeport/certificate/render' : 
    <div id="certificate-container" class=" certificate-container_passeport">
      <div>
          <img class="logo_company" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name">${first_name} ${last_name}</h3>
        <h4 class= "date_today">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>
  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+parcours-manager-fr+parcours-manager-fr/certificate/render' :
    <div id="certificate-container" class=" certificate-container_manager">
      <div>
          <img class="logo_company_manager" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_manager">${first_name} ${last_name}</h3>
        <h4 class= "date_today_manager">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>
  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+FR+V1/certificate/render' :
    <div id="certificate-container" class=" certificate-container_data-ia">
      <div>
          <img class="logo_company_data-ia" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_manager">${first_name} ${last_name}</h3>
        <h4 class= "date_today_data-ia">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>
  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+Netexplo_expedition+2018_T2_expedition/certificate/render' :
    <div id="certificate-container" class="certificate-container_expedition">
      <div>
          <img class="logo_company_expedition" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_expedition">${first_name} ${last_name}</h3>
        <h4 class= "date_today_expedition">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>
  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+Netexplo_voyages+2018_T2_voyages/certificate/render' :
    <div id="certificate-container" class=" certificate-container_voyages">
      <div>
          <img class="logo_company_voyages" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_voyages">${first_name} ${last_name}</h3>
        <h4 class= "date_today_voyages">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>
  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+socialschoolfr+SSFR/certificate/render' :
    <div id="certificate-container" class=" certificate-container_socialschool">
      <div>
          <img class="logo_company_socialschool" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_socialschool">${first_name} ${last_name}</h3>
        <h4 class= "date_today_socialschool">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

  <!-- english section -->

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+Netexplo_passeport_EN+2018_T2_passeport_EN/certificate/render' :
  <div id="certificate-container" class=" certificate-container_passeport_en">
    <div>
        <img class="logo_company" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
      <h3 class="user_name">${first_name} ${last_name}</h3>
      <h4 style="left: 200px;" class= "date_today">${date.today().strftime("%d/%m/%Y")}</h4>
    </div>
  </div>
  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+manager+manager-en/certificate/render' :
    <div id="certificate-container" class=" certificate-container_manager_en">
      <div>
          <img class="logo_company_manager" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_manager">${first_name} ${last_name}</h3>
        <h4 style="left: 231px;" class= "date_today_manager">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>
  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+EN+V1/certificate/render' :
    <div id="certificate-container" class=" certificate-container_data-ia_en">
      <div>
          <img class="logo_company_data-ia" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <!-- <h3 style="top: 66px;" class="user_name_data-ia">${first_name} ${last_name}</h3> -->
        <h3 class="user_name_data-ia">${first_name} ${last_name}</h3>
        <h4 class= "date_today_data-ia">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+Netexplo_expeditions_en+2018_T2_expeditions_en/certificate/render' :
    <div id="certificate-container" class="certificate-container_expedition_en">
      <div>
          <img class="logo_company_expedition" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_expedition">${first_name} ${last_name}</h3>
        <h4 style="left: 223px;" class= "date_today_expedition">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+Netexplo_travel+2018_T2_travel/certificate/render' :
    <div id="certificate-container" class=" certificate-container_voyages_en">
      <div>
          <img class="logo_company_voyages" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_voyages">${first_name} ${last_name}</h3>
        <h4 style="left: 224px;" class= "date_today_voyages">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+socialschoolen+SSEN/certificate/render' :
    <div id="certificate-container" class=" certificate-container_socialschool_en">
      <div>
          <img class="logo_company_socialschool" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_socialschool">${first_name} ${last_name}</h3>
        <h4 style="left: 210px;" class= "date_today_socialschool">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

        <!-- spanish section -->

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+12+ES/certificate/render' :
  <div id="certificate-container" class=" certificate-container_passeport_es">
    <div>
        <img class="logo_company" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
      <h3 class="user_name">${first_name} ${last_name}</h3>
      <h4 style="top: 287px;" class= "date_today">${date.today().strftime("%d/%m/%Y")}</h4>
    </div>
  </div>
  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+manager+manager-es/certificate/render' :
    <div id="certificate-container" class=" certificate-container_manager_es">
      <div>
          <img class="logo_company_manager" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_manager">${first_name} ${last_name}</h3>
        <h4 class= "date_today_manager">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>
  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+data_ia+2020_ES/certificate/render' :
    <div id="certificate-container" class=" certificate-container_data-ia_es">
      <div>
          <img class="logo_company_data-ia" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <!-- <h3 style="top: 65px;" class="user_name_data-ia">${first_name} ${last_name}</h3> -->
        <h3 class="user_name_data-ia">${first_name} ${last_name}</h3>
        <h4 style="top: 284px;" class= "date_today_data-ia">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+expeditions+2020_es/certificate/render' :
    <div id="certificate-container" class="certificate-container_expedition_es">
      <div>
          <img class="logo_company_expedition" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_expedition">${first_name} ${last_name}</h3>
        <h4 class= "date_today_expedition">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+travel+2020_es/certificate/render' :
    <div id="certificate-container" class=" certificate-container_voyages_es">
      <div>
          <img class="logo_company_voyages" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_voyages">${first_name} ${last_name}</h3>
        <h4 class= "date_today_voyages">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+socialschooles+SSES/certificate/render' :
    <div id="certificate-container" class=" certificate-container_socialschool_es">
      <div>
          <img class="logo_company_socialschool" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_socialschool">${first_name} ${last_name}</h3>
        <h4 class= "date_today_socialschool">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

      <!-- german section -->

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+13+DE/certificate/render' :
  <div id="certificate-container" class=" certificate-container_passeport_de">
    <div>
        <img class="logo_company" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
      <h3 class="user_name">${first_name} ${last_name}</h3>
      <h4 style="top: 289px;left: 175px;" class= "date_today">${date.today().strftime("%d/%m/%Y")}</h4>
    </div>
  </div>
  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+manager+manager-de/certificate/render' :
    <div id="certificate-container" class=" certificate-container_manager_de">
      <div>
          <img class="logo_company_manager" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_manager">${first_name} ${last_name}</h3>
        <h4 style="top: 259px;left: 242px;" class= "date_today_manager">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>
  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+data_ia+2020_DE/certificate/render' :
    <div id="certificate-container" class=" certificate-container_data-ia_de">
      <div>
          <img class="logo_company_data-ia" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_data-ia">${first_name} ${last_name}</h3>
        <h4 style="left: 178px;top: 285px;" class= "date_today_data-ia">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+expeditions+2020_de/certificate/render' :
    <div id="certificate-container" class="certificate-container_expedition_de">
      <div>
          <img class="logo_company_expedition" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_expedition">${first_name} ${last_name}</h3>
        <h4 style="left: 196px;" class= "date_today_expedition">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+travel+2020_de/certificate/render' :
    <div id="certificate-container" class=" certificate-container_voyages_de">
      <div>
          <img class="logo_company_voyages" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_voyages">${first_name} ${last_name}</h3>
        <h4 style="top: 285px;left: 199px;" class= "date_today_voyages">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

  % elif request.path == '/tma_apps/course-v1:edf-netexploacademy+socialschoolde+SSDE/certificate/render' :
    <div id="certificate-container" class=" certificate-container_socialschool_de">
      <div>
          <img class="logo_company_socialschool" src="/media/microsite/${org}/images/certificate/logo.png" alt="logo" />
        <h3 class="user_name_socialschool">${first_name} ${last_name}</h3>
        <h4 style="left: 184px;" class= "date_today_socialschool">${date.today().strftime("%d/%m/%Y")}</h4>
      </div>
    </div>

  % endif
</div>
%else:
  <div id="noCertificateMessage">
      <h3>Certificat Non Disponible</h3>
      <p>Vous n'avez pas atteint le score minimal requis pour obtenir votre certificat.</p>
  </div>
%endif

<!-- PDF CREATOR-->
<script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.debug.js"></script>
<script>
  function CertificateToPdf(){
     html2canvas(document.getElementById("certificate-container"), {
      onrendered : function (canvas){
       var img=canvas.toDataURL("image/png");
       var doc = new jsPDF({orientation: 'landscape'});
       doc.addImage(img, "PNG", 30, 35);
       doc.save("certificat.pdf");
      }
    })
  }
  //AVOID INTERNET EXPLORER NOT WORKING WITH HTML2CANVAS
  $(document).ready(function(){
    if(navigator.userAgent.indexOf("Firefox")<0 && navigator.userAgent.indexOf("Chrome")<0 && navigator.userAgent.indexOf("Safari")<0){
    $('#pdf-btn-wrapper').html("${_('Download PDF : This feature is not available on Internet Explorer. Please use Chrome Mozilla or Safari to get your pdf')}")
    }
  })
</script>

