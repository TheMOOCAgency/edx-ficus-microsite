## mako
<%namespace name='static' file='static_content.html'/>
<%!
from django.core.urlresolvers import reverse
from django.utils.translation import ugettext as _
%>
<!DOCTYPE html> 
<html>
      <head>
     <meta charset='utf-8'>
         <meta name='viewport' content='width=device-width, initial-scale=1.0'>
         <title id='masterTitle'></title>
		 	<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js'></script>
      </head>
      <style>@import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@300;515&display=swap');</style>
      <body style="display: none">
         <nav id = "nav"class="navbar navbar-default">
            <div class="container-fluid">
               <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                     <ul class="nav navbar-nav navbar-right">
                        <li><a href="" id="loginLink1">Connexion</a></li>
                        <li><a href="" id="registerLink1">Inscription</a></li>
                     </ul>
                  </button>
               </div>
               <div id="navbar" class="navbar-collapse collapse">
                  <ul class="nav navbar-nav">
                     <li>
                        <a class="navbar-brand "><img class="logo_entrNav"></a>
                        <a class="navbar-brand "><img class="logoNav"></a>
                     </li>
                  </ul>
                  <ul class="nav navbar-nav navbar-right">
                     <% languages = static.get_released_languages() %>
                     <ol class="user">
                     <li class="primary" style="list-style:none">
                        <form action="/i18n/setlang/" method="post" class="settings-language-form" id="language-settings-form">
                           <input type="hidden" id="csrf_token" name="csrfmiddlewaretoken" value="${csrf_token}">
                           % if user.is_authenticated():
                           <input title="preference api" type="hidden" class="url-endpoint" value="${reverse('preferences_api', kwargs={'username': user.username})}" data-user-is-authenticated="true">
                           % else:
                           <input title="session update url" type="hidden" class="url-endpoint" value="${reverse('session_language')}" data-user-is-authenticated="false">
                           % endif
                           <label><span class="sr"></span>
                           <!--LANGUAGE FLAGS-->
                           <div id="lang-content">
                              <img src="/media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/gb.png" id="en">
                              <img src="/media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/fr.png" id="fr">
                              <select class="input select language-selector" id="settings-language-value" name="language" size="2" >
                                 % for language in languages:
                                 % if language[0] =="en" or language[0] =="fr":
                                 % if language[0] == LANGUAGE_CODE:
                                    <option value="${language[0]}" selected="selected">${language[0]}</option>
                                 % else:
                                    <option value="${language[0]}">${language[0]}</option>
                                 % endif
                                 % endif
                                 % endfor
                              </select>
                           </div>
                           </label>
                        </form>
                     </li>
                     </ol>



                     <style>
                     /*LANGUAGE FLAGS*/
                     .language-selector {
                        display: none;
                     }
                     #lang-content {
                        width: 60px;
                        height: 24px;
                     }
                     #lang-content img{
                        width: 25px;
                     }
                     </style>

                     <script>
                     //LANGUAGE FLAGS
                     $('#en').on('click', function() {
                        $('#settings-language-value > option[value="en"]').attr('selected','selected');
                        $('#settings-language-value > option[value="fr"]').removeAttr('selected');
                        var event = jQuery.Event( "submit" );
                        $( "form" ).first().trigger( event );
                     }
                     );
                     $('#fr').on('click', function() {
                        $('#settings-language-value > option[value="fr"]').attr('selected','selected');
                        $('#settings-language-value > option[value="en"]').removeAttr('selected');
                        var event = jQuery.Event( "submit" );
                        $( "form" ).first().trigger( event );
                     }

                     );
                     </script>

                     <li><a href="" id="registerLink2" class="rg">Inscription</a></li>
                     <li><a href="" id="loginLink2" class="cx">Connexion</a></li>       
                  </ul>
               </div>
               <!--/.nav-collapse -->             
            </div>
            <!--/.container-fluid -->          
         </nav>
         <div id="titleBand">
            <h1 id="mainTitle1"></h1>
            <h1 pre id="mainTitle2"></h1>
            <h1 id="mainTitle3" style="display: none"></h1>
         </div>

         <section id="se1">
            <div class="video_container">
               <video id="videoHeader" autoplay="true" loop="true" preload="metadata" muted="muted">
                 <source src="https://player.vimeo.com/external/455818234.hd.mp4?s=31360b0ee904b84b57ad40e1290d16d3597e2c0b&profile_id=174" type="video/mp4">
                 Your browser does not support the video tag.
               </video>
            </div>
            <div class="row vertical-center">
               <div class="col-md-12 text-center">
                  <div class="container-fluid" id="containerTitleBand">
                     <div class="col text-center">                  
                        <button class="btn btn-default butn jbo rg registerJumbo" href="" id="subscribeButn"> inscription </button>
                        <button class="btn btn-default butn jbo cx connexJumbo" href="" id="loginButn">connexion</button>  
                                     
                     </div>
                  </div>
               </div>
            </div>
         </section>

         <section id="se2">
         <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 pad4 " >
               <h2 class="text-center sectionTitle"></h2>
               <h2 class="surligner">___________________</h2>
               <h3 class="sectionSubTitle"></h3>
               <div class="overMars">
                  <div class="container">
                     <div class="row" id ="markWeeks">
                        <div class="col-md-12"></div>
                     </div>
                  </div>
               </div>
               <h3 class="additionalText"></h3>
               <div id="additionalElementsContainer">
                  <div class="additionalElement">
                     <img src = 'media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/pictoDiezBlanc.png'></img>
                     <div id="additionalElement1"></div>
                  </div>
                  <div class="additionalElement">
                     <img src = 'media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/pictoDiezBlanc.png'></img>
                     <div id="additionalElement2"></div>
                  </div>
                  <div class="additionalElement">
                     <img src = 'media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/pictoDiezBlanc.png'></img>
                     <div id="additionalElement3"></div>
                  </div>
               </div>
            </div>
         </div>
         </div>          
         </section>
            
         <div class='separatorContainer'>
            <h2 class="surligner inline">___________________</h2><img src = 'media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/pictoDiez.png'></img><h2 class="surligner inline">___________________</h2>
         </div>

         <section id="se3">
            <h2 class="text-center sectionTitle"></h2>
            <h3 class="sectionSubTitle"></h3>
            <div id="markMoock"></div>
         </section>

         <div class='separatorContainer'>
            <h2 class="surligner inline">___________________</h2><img src = 'media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/pictoDiez.png'></img><h2 class="surligner inline">___________________</h2>
         </div>

         <footer id="footer">
            <div class="row" style="display: block">
               <div class="col text-center">
                  <button class="btn btn-default butn" id="subscribeButn2">
                  JE Mâ€™INSCRIS !</button> 
               </div>
            </div>
            <div class="row footerBottom">
               <div id="footerIcons" >
                  <img class="footerIcons" src='media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/logo_entrNav.jpg'></img>
                  <img class="footerIcons" src='media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/croppedLogo.jpg'></img>
                  <img class="footerIcons" src='media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/logo.png'></img>
                  <img class="footerIcons onRight" src='media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/logo_sombre.png'></img>
               </div>
            </div>
            </div>          
         </footer>
         <script>   
       
				 var envDefault = "developement"
					 var organisation = "mooc-entreprise-harcelementsexuel"
					 	var urlCompose
					 var i 
                     var iter
                     var tbTitle
                     var tbText
                     var pathRegister = "/register"
                     var pathLogin = "/login"
                     var course_id = ""
                     var enrollment_action = ""
                     var connectLink = ""
                     var pathMedia = "media/microsite/"
                     var micrositeName 
                     var folderPb = "/pagebuilder"
                     var imgSrc = "/assets/img/"
                     var thumbnailStr = "thumbnailStr"
                     var contentImg = "contentImg"
                     var thumbnailObj
                     var thumbnailObjObj
                     var composeurUrlSrc = pathMedia + micrositeName + folderPb + imgSrc +thumbnailStr
                     var composeurUrlSrc2 = pathMedia + micrositeName + folderPb + imgSrc +contentImg
                     var termPng = ".png"
                     var termJpg = ".jpg"
                     var vNone = 'none'
                     var thumbnailMOOC =  "<div class='col-md-3 col-sm-6 item col-xs-12'><div class='box'><img class='img-rounded' src="+composeurUrlSrc+i+termPng+"><h3 class='name' >"+tbTitle+"</h3> <p class='description' >"+tbText+"</p></div> </div>"
                     
                     
                     var thumbnailImgSrc
                     var titleThumbnail
                     var titleWeeks
                     var iconoImgSrc
                     
                     var thumbnailChap =  "<div class='col-md-4 thumbnailImg'> <div class='thumbnail'><img class='tbImg'src="+thumbnailImgSrc+"><div class='caption'> <h3 >"+titleThumbnail+"</h3><img class='tbIc' src="+iconoImgSrc+"> <p class='weekSp'>"+titleWeeks+"</p><p class='under_s2'></p></div> </div></div>"
            
                     var titleThumb
                     var imgThumbSrcIcon
                     var imgThumbSrc
                     var pWeeksTitle
                     var pWeeksContent
            
                     var thumbnailChapEsc =  "<div class='col-md-4 noflex'><div class='thumbnail'>  <img src="+imgThumbSrc+ "class='thumbMg'> <div class='caption'> <h3 class='h3Thumb'  " + titleThumb + "</h3><img src="+imgThumbSrcIcon+" class='thumbMg'><p class='pWeeksTitle'>"+pWeeksTitle+"</p> <p class='pWeeksContent'>"+pWeeksContent+"</p></div>  </div>  </div>"
            
                        var swapDisplay = function(elm){
                              var elmt = elm
                              elmt.style.display = 'none'
                        }
                     var getInfo= function(){
					 micrositeName  = organisation
					 if (envDefault=='developement'){pathMedia =  "media/microsite/"}
					 else{pathMedia =  "/media/microsite/"}
					 composeurUrlSrc = pathMedia + micrositeName + folderPb + imgSrc +thumbnailStr
                    composeurUrlSrc2 = pathMedia + micrositeName + folderPb + imgSrc +contentImg
					urlCompose =pathMedia + micrositeName + "/pagebuilder/json/info.json"
                     }
			
					var scriptLinkGenerator =  function(){
		
						var scriptSrcArr = ["bootstrap.min.js","jquery.scrollify.js"]
						var script = document.createElement('script');
						var script2 = document.createElement('script');
						var mainPathB= pathMedia + micrositeName + folderPb + "/assets//bootstrap/js/"
						script.id = 'Sid1';
						script.src = mainPathB+scriptSrcArr[0];
						script2.id = 'Sid2';
						script2.src = mainPathB+scriptSrcArr[1];
						document.head.appendChild(script);
						document.head.appendChild(script2);
				
						var lsSrcArr = ["/pagebuilder/assets/bootstrap/css/bootstrap-theme.min.css","/pagebuilder/assets/bootstrap/css/bootstrap.min.css","/pagebuilder/css/style.css"]
						var link1 = document.createElement('link');
						link1.id = 'id1';
						link1.rel = 'stylesheet';
						link1.href = pathMedia+ micrositeName + lsSrcArr[0];
						var link2 = document.createElement('link');
						link2.id = 'id2';
						link2.rel = 'stylesheet';
						link2.href = pathMedia+ micrositeName + lsSrcArr[1];
						var link3 = document.createElement('link');
						link3.id = 'id3';
						link3.rel = 'stylesheet';
						link3.href = pathMedia+ micrositeName + lsSrcArr[2];
						document.head.appendChild(link1);
						document.head.appendChild(link2);
                  document.head.appendChild(link3);
                  
                  $("#loginLink1").attr("href",pathLogin + connectLink)
                  $("#registerLink1").attr("href",pathRegister + connectLink)
                  $("#loginLink2").attr("href",pathLogin + connectLink)
                  $("#registerLink2").attr("href",pathRegister + connectLink)
                  $("#loginButn").click(function(){window.location.href = pathLogin + connectLink})
                  $("#subscribeButn").click(function(){window.location.href = pathRegister + connectLink})
                  $("#subscribeButn2").click(function(){window.location.href = pathRegister + connectLink})

                  // texts
                  $("#subscribeButn2").text(objJson.page.imIn)
                  $("#loginLink1").text(objJson.page.login)
                  $("#loginLink2").text(objJson.page.login)
                  $("#loginButn").text(objJson.page.login)
                  $("#registerLink1").text(objJson.page.register)
                  $("#registerLink2").text(objJson.page.register)
                  $("#subscribeButn").text(objJson.page.register)
		         }
			
            var bindindFunctionNav = function(){
               var logoSrc  = pathMedia + micrositeName + folderPb + imgSrc +"logo.png"
               var logo_entrepriseSrc  = pathMedia + micrositeName + folderPb + imgSrc +"logo_entrNav.jpg"
					$(".logoNav").attr("src",logoSrc)
               $(".logo_entrNav").attr("src",logo_entrepriseSrc)
            }
            
            var bindindFunctionA = function(){
            	iter =  objJson.container.section2.nbrThumbnail
            	for (i = 0; i < iter ; i++ ){
            		thumbnailObj = objJson.container.section2.thumbnail[i]
            		titleThumb = thumbnailObj.title
                  pWeeksTitle = thumbnailObj.subtitle
            		pWeeksContent = thumbnailObj.content
            		imgThumbSrc = composeurUrlSrc2+i+termPng
                  var visualModule = ""

                  if (imgThumbSrc === "media/microsite/mooc-entreprise-harcelementsexuel/pagebuilder/assets/img/contentImg5.png") {
                     visualModule = pWeeksTitle
                     titleThumb = ""
                  } else {
                     visualModule = "<img src="+imgThumbSrc+ " class='thumbMg'><div class='caption'><p class='pWeeksTitle'>"+pWeeksTitle+"</p><h2 class='surligner'>__________</h2>"
                  }
                  
                  thumbnailChapEsc =  "<div class='col-md-6 noflex ChapEsc ' ><div class='thumbnail'><h3 class='titleMiniThumb'> " + titleThumb + "</h3>"+visualModule+"<p class='pWeeksContent'>"+pWeeksContent+"</p></div>  </div>  </div>"
            
            		$('#markWeeks').append(thumbnailChapEsc)
            	}         
            }

            var bindindFunctionB = function(){
            	iter =  objJson.container.section3.nbrThumbnail
            	for (i = 0; i < iter ; i++ ){
            		thumbnailObj = objJson.container.section3.thumbnail[i]
            		tbTitle = thumbnailObj.title
            		tbText = thumbnailObj.text
            		thumbnailMOOC =  "<div class='col-md-3 col-sm-6 item col-xs-12'><div class='box'><img class='img-rounded moocIco' src="+composeurUrlSrc+i+termPng+"><h3 class='name' >"+tbTitle+"</h3> <p class='description' >"+tbText+"</p></div> </div>";
            		$('#markMoock').append(thumbnailMOOC)
            	} 
            }
                     
            var bindindFunctionSection1= function(){
               var mainTitleContentTitle1 = objJson.container.section1.title.title1
               var mainTitleContentTitle2 = objJson.container.section1.title.title2
               $('#mainTitle1').text(mainTitleContentTitle1)
               $('#mainTitle2').html(mainTitleContentTitle2)
            }

            var bindindFunctionSection2= function(){
               var mainTitleContent = objJson.container.section2.title
               var subTitleContent = objJson.container.section2.subtitle
               var additionalText = objJson.container.section2.additional_text
               var additionalElement1 = objJson.container.section2.additional_element_1
               var additionalElement2 = objJson.container.section2.additional_element_2
               var additionalElement3 = objJson.container.section2.additional_element_3
         	   $('#se2').find(".sectionTitle").text(mainTitleContent)
               $('#se2').find(".sectionSubTitle").text(subTitleContent)
               $('#se2').find(".additionalText").text(additionalText)
               $('#se2').find("#additionalElement1").text(additionalElement1)
               $('#se2').find("#additionalElement2").text(additionalElement2)
               $('#se2').find("#additionalElement3").text(additionalElement3)
            }

            var bindindFunctionSection3= function(){
               var mainTitleContent = objJson.container.section3.title
               var subTitleContent = objJson.container.section3.subtitle
            	$('#se3').find(".sectionTitle").text(mainTitleContent)
               $('#se3').find(".sectionSubTitle").text(subTitleContent)
            }
                     
            var bindindFunctionMeta = function(){
            	var mainTitleContent = objJson.page.title
            	$("#masterTitle").text(mainTitleContent)
            }
            
            var masterBind= function(){
				   scriptLinkGenerator(objJson);
            	bindindFunctionA();
            	bindindFunctionB();
            	bindindFunctionNav();
            	bindindFunctionSection1();
               bindindFunctionSection2();
               bindindFunctionSection3();
               bindindFunctionMeta ();
             }
            
            var objJson
            
            getInfo();
            var a = new XMLHttpRequest();

            a.open("GET",urlCompose,true);
            a.onreadystatechange = function() {
              if( this.readyState == 4) {
            	if( this.status == 200) {
                  var response= JSON.parse(this.response)
                  if ("${LANGUAGE_CODE}" === "fr") {
                     objJson = response.fr
                     course_id = "course-v1:mooc-entreprise-harcelementsexuel+ME01+2020_ME"
                  } else {
                     objJson = response.en
                     course_id = "course-v1:mooc-entreprise-harcelementsexuel+ME01GB+2020_ME"
                  }
                  enrollment_action = "enroll"
                  connectLink = "?course_id=" + course_id + "&enrollment_action=" + enrollment_action
                  masterBind();
            	}
            	else alert("HTTP error "+this.status+" "+this.statusText);
              }
            }
            a.send();
            a.addEventListener('loadend', $("body").css({"display":"inherit"}));
            
            $(".scroll").click(function() {
            	$('html, body').animate({
            		scrollTop: $("#se2").offset().top
            	}, 2000);
            });
			</script>       
      </body>
   </html>

